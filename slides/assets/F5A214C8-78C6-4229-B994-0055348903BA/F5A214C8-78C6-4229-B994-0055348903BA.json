{"assets":{"8B5791FE1C155FB2F45D00821DF98A1F":{"type":"texture","index":0,"assetRequest":{"type":"slide","state":"contents","slide":"none"},"url":{"native":"assets\/F5A214C8-78C6-4229-B994-0055348903BA.pdf"},"width":1920,"height":1080},"E7744CA6132AF934509CC30A7869B78E":{"type":"texture","index":1,"assetRequest":{"type":"slide","state":"contents","slide":"none"},"url":{"native":"assets\/F5A214C8-78C6-4229-B994-0055348903BA.pdf"},"width":1920,"height":1080}},"events":[{"effects":[{"beginTime":0,"baseLayer":{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"0","layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,-0.00035007912466775983,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":false,"singleTextureOpacity":1,"textureType":0,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"E7744CA6132AF934509CC30A7869B78E"},{"animations":[{"timeOffset":0,"from":{"scalar":false},"beginTime":0,"repeatCount":0,"fillMode":"both","property":"hidden","autoreverses":false,"duration":0.01,"to":{"scalar":true}}],"layers":[],"texturedRectangle":{"isBackgroundTexture":false,"singleTextureOpacity":1,"textureType":0,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"8B5791FE1C155FB2F45D00821DF98A1F"}]}]},"effects":[],"duration":0.01,"type":"transition","attributes":{"direction":0},"name":"none","objectID":"0"}],"automaticPlay":false,"hyperlinks":[],"accessibility":[{"text":";Handlers","targetRectangle":{"y":-2181.0603103637695,"x":243.05955505371094,"width":151.716796875,"height":33}},{"text":"(defn echo-handler [request]","targetRectangle":{"y":-2148.0603103637695,"x":243.05955505371094,"width":472.0078125,"height":33}},{"text":"  (ok (with-out-str (pp\/pprint request))))","targetRectangle":{"y":-2115.0603103637695,"x":243.05955505371094,"width":708.01171875,"height":33}},{"text":"(defn weapons-query-handler [{{:strs [name]} :params :keys [conn] :as request}]","targetRectangle":{"y":-2049.0603103637695,"x":243.05955505371094,"width":1331.736328125,"height":33}},{"text":"  (ok","targetRectangle":{"y":-2016.0603103637695,"x":243.05955505371094,"width":84.287109375,"height":33}},{"text":"    (if name","targetRectangle":{"y":-1983.0603103637695,"x":243.05955505371094,"width":202.2890625,"height":33}},{"text":"      (w\/weapons @conn [name])","targetRectangle":{"y":-1950.0603103637695,"x":243.05955505371094,"width":505.72265625,"height":33}},{"text":"      (w\/everybodys-weapons @conn))))","targetRectangle":{"y":-1917.0603103637695,"x":243.05955505371094,"width":623.724609375,"height":33}},{"text":"(defn add-weapons-handler [{:keys [params conn] :as request}]","targetRectangle":{"y":-1851.0603103637695,"x":243.05955505371094,"width":1028.302734375,"height":33}},{"text":"  (let [data (map (fn [[k v]] {:name k :weapon v}) params)]","targetRectangle":{"y":-1818.0603103637695,"x":243.05955505371094,"width":994.587890625,"height":33}},{"text":"    (do","targetRectangle":{"y":-1785.0603103637695,"x":243.05955505371094,"width":118.001953125,"height":33}},{"text":"      (d\/transact! conn data)","targetRectangle":{"y":-1752.0603103637695,"x":243.05955505371094,"width":488.865234375,"height":33}},{"text":"      (ok (w\/weapons @conn (keys params))))))","targetRectangle":{"y":-1719.0603103637695,"x":243.05955505371094,"width":758.583984375,"height":33}},{"text":"(defn files-handler [{:keys [sql-conn]}]","targetRectangle":{"y":-1653.0603103637695,"x":243.05955505371094,"width":674.296875,"height":33}},{"text":"  (ok (f\/all-processed-files sql-conn)))","targetRectangle":{"y":-1620.0603103637695,"x":243.05955505371094,"width":674.296875,"height":33}},{"text":";Routes - All data","targetRectangle":{"y":-1554.0603103637695,"x":243.05955505371094,"width":303.43359375,"height":33}},{"text":"(def basic-routes","targetRectangle":{"y":-1521.0603103637695,"x":243.05955505371094,"width":286.576171875,"height":33}},{"text":"  [[\\\"\/echo\\\" {:get echo-handler}]","targetRectangle":{"y":-1488.0603103637695,"x":243.05955505371094,"width":539.4375,"height":33}},{"text":"   [\\\"\/files\\\" {:get files-handler}]])","targetRectangle":{"y":-1455.0603103637695,"x":243.05955505371094,"width":606.8671875,"height":33}},{"text":"(def weapons-routes","targetRectangle":{"y":-1389.0603103637695,"x":243.05955505371094,"width":320.291015625,"height":33}},{"text":"  [[\\\"\/weapons\\\" weapons-query-handler]","targetRectangle":{"y":-1356.0603103637695,"x":243.05955505371094,"width":623.724609375,"height":33}},{"text":"   [\\\"\/add_weapon\\\" add-weapons-handler]])","targetRectangle":{"y":-1323.0603103637695,"x":243.05955505371094,"width":674.296875,"height":33}},{"text":";Router","targetRectangle":{"y":-1257.0603103637695,"x":243.05955505371094,"width":118.001953125,"height":33}},{"text":"(def router","targetRectangle":{"y":-1224.0603103637695,"x":243.05955505371094,"width":185.431640625,"height":33}},{"text":"  (ring\/router","targetRectangle":{"y":-1191.0603103637695,"x":243.05955505371094,"width":236.00390625,"height":33}},{"text":"    ;We were able to compose the routes here","targetRectangle":{"y":-1158.0603103637695,"x":243.05955505371094,"width":741.7265625,"height":33}},{"text":"    [basic-routes weapons-routes]","targetRectangle":{"y":-1125.0603103637695,"x":243.05955505371094,"width":556.294921875,"height":33}},{"text":"    {:data {:coercion   reitit.coercion.spec\/coercion","targetRectangle":{"y":-1092.0603103637695,"x":243.05955505371094,"width":893.443359375,"height":33}},{"text":"            :middleware [params\/wrap-params","targetRectangle":{"y":-1059.0603103637695,"x":243.05955505371094,"width":724.869140625,"height":33}},{"text":"                         middleware\/wrap-format]}}))","targetRectangle":{"y":-1026.0603103637695,"x":243.05955505371094,"width":876.5859375,"height":33}},{"text":";Global handler","targetRectangle":{"y":-960.06031036376953,"x":243.05955505371094,"width":252.861328125,"height":33}},{"text":"(def handler","targetRectangle":{"y":-927.06031036376953,"x":243.05955505371094,"width":202.2890625,"height":33}},{"text":"  (ring\/ring-handler","targetRectangle":{"y":-894.06031036376953,"x":243.05955505371094,"width":337.1484375,"height":33}},{"text":"    router","targetRectangle":{"y":-861.06031036376953,"x":243.05955505371094,"width":168.57421875,"height":33}},{"text":"    (constantly (not-found \\\"Not found\\\"))))","targetRectangle":{"y":-828.06031036376953,"x":243.05955505371094,"width":708.01171875,"height":33}},{"text":"(defmethod ig\/init-key ::jdbc\/init [_ {:keys [conn]}]","targetRectangle":{"y":-762.06031036376953,"x":243.05955505371094,"width":893.443359375,"height":33}},{"text":"  (f\/setup conn))","targetRectangle":{"y":-729.06031036376953,"x":243.05955505371094,"width":286.576171875,"height":33}},{"text":"(defn line->record [line]","targetRectangle":{"y":-663.06031036376953,"x":243.05955505371094,"width":421.435546875,"height":33}},{"text":"  (let [[name & weapons] (map cs\/trim (cs\/split line #\\\",\\\"))]","targetRectangle":{"y":-630.06031036376953,"x":243.05955505371094,"width":1011.4453125,"height":33}},{"text":"    (cond-> {:name name}","targetRectangle":{"y":-597.06031036376953,"x":243.05955505371094,"width":404.578125,"height":33}},{"text":"            (seq weapons)","targetRectangle":{"y":-564.06031036376953,"x":243.05955505371094,"width":421.435546875,"height":33}},{"text":"            (assoc :weapon weapons))))","targetRectangle":{"y":-531.06031036376953,"x":243.05955505371094,"width":640.58203125,"height":33}},{"text":"(defn file-handler [{:keys [queue conn] :as ctx} {:keys [^File file kind] :as event}]","targetRectangle":{"y":-465.06031036376953,"x":243.05955505371094,"width":1432.880859375,"height":33}},{"text":"  (when (and (#{:modify :create} kind)","targetRectangle":{"y":-432.06031036376953,"x":243.05955505371094,"width":640.58203125,"height":33}},{"text":"             (.exists file)","targetRectangle":{"y":-399.06031036376953,"x":243.05955505371094,"width":455.150390625,"height":33}},{"text":"             (.isFile file)","targetRectangle":{"y":-366.06031036376953,"x":243.05955505371094,"width":455.150390625,"height":33}},{"text":"             (cs\/ends-with? (.getName file) \\\".csv\\\"))","targetRectangle":{"y":-333.06031036376953,"x":243.05955505371094,"width":876.5859375,"height":33}},{"text":"    (do","targetRectangle":{"y":-300.06031036376953,"x":243.05955505371094,"width":118.001953125,"height":33}},{"text":"      (timbre\/debug (str \\\"Detected change to file: \\\" (.getName file)))","targetRectangle":{"y":-267.06031036376953,"x":243.05955505371094,"width":1180.01953125,"height":33}},{"text":"      (with-open [r (io\/reader file)]","targetRectangle":{"y":-234.06031036376953,"x":243.05955505371094,"width":623.724609375,"height":33}},{"text":"        (timbre\/debug \\\"Adding data to queue.\\\")","targetRectangle":{"y":-201.06031036376953,"x":243.05955505371094,"width":775.44140625,"height":33}},{"text":"        (doseq [line (line-seq r)]","targetRectangle":{"y":-168.06031036376953,"x":243.05955505371094,"width":573.15234375,"height":33}},{"text":"          (dq\/put! queue :my-queue line)))","targetRectangle":{"y":-135.06031036376953,"x":243.05955505371094,"width":708.01171875,"height":33}},{"text":"      (f\/insert-file conn {:name (.getName file) :processed (Date.)})))","targetRectangle":{"y":-102.06031036376953,"x":243.05955505371094,"width":1196.876953125,"height":33}},{"text":"  ctx)","targetRectangle":{"y":-69.060310363769531,"x":243.05955505371094,"width":101.14453125,"height":33}},{"text":"(defn queue->dsdb [{:keys [queue-name queue dsdb]}]","targetRectangle":{"y":-3.0603103637695312,"x":243.05955505371094,"width":859.728515625,"height":33}},{"text":"  ;(timbre\/debug \\\"Checking for new items in queue...\\\")","targetRectangle":{"y":29.939689636230469,"x":243.05955505371094,"width":910.30078125,"height":33}},{"text":"  (when-some [task (dq\/take! queue queue-name 10 nil)]","targetRectangle":{"y":62.939689636230469,"x":243.05955505371094,"width":910.30078125,"height":33}},{"text":"    (do","targetRectangle":{"y":95.939689636230469,"x":243.05955505371094,"width":118.001953125,"height":33}},{"text":"      (timbre\/debug \\\"Putting data into datascript\\\")","targetRectangle":{"y":128.93968963623047,"x":243.05955505371094,"width":859.728515625,"height":33}},{"text":"      (d\/transact! dsdb [(line->record @task)])","targetRectangle":{"y":161.93968963623047,"x":243.05955505371094,"width":792.298828125,"height":33}},{"text":"      (dq\/complete! task))))","targetRectangle":{"y":194.93968963623047,"x":243.05955505371094,"width":472.0078125,"height":33}},{"text":"(def config","targetRectangle":{"y":260.93968963623047,"x":243.05955505371094,"width":185.431640625,"height":33}},{"text":"  {::jdbc\/connection       {:connection-uri \\\"jdbc:h2:mem:mem_only\\\"}","targetRectangle":{"y":293.93968963623047,"x":243.05955505371094,"width":1129.447265625,"height":33}},{"text":"   ::jdbc\/init             {:conn (ig\/ref ::jdbc\/connection)}","targetRectangle":{"y":326.93968963623047,"x":243.05955505371094,"width":1028.302734375,"height":33}},{"text":"   ::datascript\/connection w\/schema","targetRectangle":{"y":359.93968963623047,"x":243.05955505371094,"width":590.009765625,"height":33}},{"text":"   ::hawk\/watch            {:groups [{:paths   [\\\"example\\\"]","targetRectangle":{"y":392.93968963623047,"x":243.05955505371094,"width":977.73046875,"height":33}},{"text":"                                      :handler #'file-handler}]","targetRectangle":{"y":425.93968963623047,"x":243.05955505371094,"width":1062.017578125,"height":33}},{"text":"                            :queue  (ig\/ref ::durable\/queues)","targetRectangle":{"y":458.93968963623047,"x":243.05955505371094,"width":1028.302734375,"height":33}},{"text":"                            :conn   (ig\/ref ::jdbc\/connection)}","targetRectangle":{"y":491.93968963623047,"x":243.05955505371094,"width":1062.017578125,"height":33}},{"text":"   ::durable\/queues        {:delete-on-halt? true","targetRectangle":{"y":524.93968963623047,"x":243.05955505371094,"width":826.013671875,"height":33}},{"text":"                            :directory       \\\"\/tmp\\\"}","targetRectangle":{"y":557.93968963623047,"x":243.05955505371094,"width":876.5859375,"height":33}},{"text":"   ::scheduling\/job        {:job        #'queue->dsdb","targetRectangle":{"y":590.93968963623047,"x":243.05955505371094,"width":893.443359375,"height":33}},{"text":"                            :queue-name :my-queue","targetRectangle":{"y":623.93968963623047,"x":243.05955505371094,"width":826.013671875,"height":33}},{"text":"                            :schedule   {:in [5 :seconds] :every :second}","targetRectangle":{"y":656.93968963623047,"x":243.05955505371094,"width":1230.591796875,"height":33}},{"text":"                            :queue      (ig\/ref ::durable\/queues)","targetRectangle":{"y":689.93968963623047,"x":243.05955505371094,"width":1095.732421875,"height":33}},{"text":"                            :dsdb       (ig\/ref ::datascript\/connection)}","targetRectangle":{"y":722.93968963623047,"x":243.05955505371094,"width":1230.591796875,"height":33}},{"text":"   ::web\/server            {:host     \\\"0.0.0.0\\\"","targetRectangle":{"y":755.93968963623047,"x":243.05955505371094,"width":792.298828125,"height":33}},{"text":"                            :port     3000","targetRectangle":{"y":788.93968963623047,"x":243.05955505371094,"width":708.01171875,"height":33}},{"text":"                            :sql-conn (ig\/ref ::jdbc\/connection)","targetRectangle":{"y":821.93968963623047,"x":243.05955505371094,"width":1078.875,"height":33}},{"text":"                            :conn     (ig\/ref ::datascript\/connection)","targetRectangle":{"y":854.93968963623047,"x":243.05955505371094,"width":1180.01953125,"height":33}},{"text":"                            :handler  #'handler}})","targetRectangle":{"y":887.93968963623047,"x":243.05955505371094,"width":842.87109375,"height":33}},{"text":"(defonce sys (create config))","targetRectangle":{"y":953.93968963623047,"x":243.05955505371094,"width":488.865234375,"height":33}}],"baseLayer":{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"0","layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,-0.00035007912466775983,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":false,"singleTextureOpacity":1,"textureType":0,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"8B5791FE1C155FB2F45D00821DF98A1F"}]}]}}]}